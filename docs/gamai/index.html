<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Gamai - Forky</title>


        <!-- Custom HTML head -->
        <script type="module">
        	import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
        	mermaid.initialize({ startOnLoad: true });
        </script>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../src/custom/index.css">

    </head>
    <body>
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = null;
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../index.html">Forky</a></li><li class="chapter-item expanded affix "><li class="part-title">Crates</li><li class="chapter-item expanded "><a href="../forky_cli/index.html"><strong aria-hidden="true">1.</strong> Command Line Interface</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../forky_cli/sweet.html"><strong aria-hidden="true">1.1.</strong> sweet</a></li><li class="chapter-item expanded "><a href="../forky_cli/watch.html"><strong aria-hidden="true">1.2.</strong> watch</a></li><li class="chapter-item expanded "><a href="../forky_cli/mod.html"><strong aria-hidden="true">1.3.</strong> mod</a></li><li class="spacer"></li></ol></li><li class="chapter-item expanded "><a href="../sweet/index.html"><strong aria-hidden="true">2.</strong> Sweet</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../sweet/native/index.html"><strong aria-hidden="true">2.1.</strong> Quickstart - Native</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../sweet/native/runner.html"><strong aria-hidden="true">2.1.1.</strong> Native Runner</a></li><li class="chapter-item expanded "><a href="../sweet/native/async.html"><strong aria-hidden="true">2.1.2.</strong> Async Tests</a></li><li class="chapter-item expanded "><a href="../sweet/native/webdriver.html"><strong aria-hidden="true">2.1.3.</strong> Web Driver</a></li></ol></li><li class="chapter-item expanded "><a href="../sweet/web/index.html"><strong aria-hidden="true">2.2.</strong> Quickstart - Web</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../sweet/web/matchers.html"><strong aria-hidden="true">2.2.1.</strong> Matchers</a></li><li class="chapter-item expanded "><a href="../sweet/web/end-to-end.html"><strong aria-hidden="true">2.2.2.</strong> End-To-End</a></li></ol></li><li class="chapter-item expanded "><a href="../sweet/matchers.html"><strong aria-hidden="true">2.3.</strong> Matchers</a></li><li class="chapter-item expanded "><a href="../sweet/macros.html"><strong aria-hidden="true">2.4.</strong> Macros</a></li><li class="chapter-item expanded "><a href="../sweet/workspaces.html"><strong aria-hidden="true">2.5.</strong> Workspaces</a></li><li class="chapter-item expanded "><a href="../sweet/cicd.html"><strong aria-hidden="true">2.6.</strong> CI / CD</a></li><li class="chapter-item expanded "><a href="../sweet/faq.html"><strong aria-hidden="true">2.7.</strong> FAQ</a></li><li class="chapter-item expanded "><a href="../sweet/changelog.html"><strong aria-hidden="true">2.8.</strong> Changelog</a></li><li class="spacer"></li></ol></li><li class="chapter-item expanded "><a href="../gamai/index.html" class="active"><strong aria-hidden="true">3.</strong> Gamai</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../gamai/selectors.html"><strong aria-hidden="true">3.1.</strong> Selectors</a></li><li class="spacer"></li></ol></li><li class="chapter-item expanded "><li class="part-title">Demos</li><li class="chapter-item expanded "><a href="../demos/bevy-webxr.html"><strong aria-hidden="true">4.</strong> Bevy WebXR</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Misc</li><li class="chapter-item expanded "><a href="../other/contributing.html"><strong aria-hidden="true">5.</strong> Contributing</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Forky</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="gamai"><a class="header" href="#gamai">Gamai</a></h1>
<p><code>gamai</code> is a flexible task switching library suitable for game AI, robotics &amp; other performance-critical environments. It features a modular tree structure and supports multiple selector paradigms like Utility AI and Goal Oriented Action Planning (GOAP). The ECS implementation allows for opportunistic parallelism, ensuring trees are processed as quickly as possible.</p>
<p><strong>With Bevy</strong></p>
<p>If used with Bevy there is no blackboard, as each node is a regular Bevy system with the same access to entities &amp; resources.</p>
<p><strong>Without Bevy</strong></p>
<p>The lightweight <a href="https://crates.io/crates/bevy_ecs"><code>bevy_ecs</code></a> crate that drives Gamai makes for an excellent blackboard, scheduling nodes to safely run in parallel and storing data efficiently for the CPU cache.</p>
<h2 id="features"><a class="header" href="#features">Features</a></h2>
<ul>
<li>üå¥ Declarative RSX Trees</li>
<li>üî• Automatic Parallelism &amp; System Ordering</li>
<li>‚úçÔ∏è No Blackboard</li>
<li>üåà Multi-paradigm</li>
<li>üåç With or without Bevy</li>
</ul>
<h2 id="trees"><a class="header" href="#trees">Trees</a></h2>
<p>Trees are defined using familiar RSX patterns like those found in web UI libraries. A unique aspect of <code>gamai</code> is that trees are parsed at <em>compile time</em> which gives us the nessesary type information for the parallel scheduler in <code>bevy_ecs</code>.</p>
<pre><code class="language-rs">#[tree_builder]
pub fn MyTree() -&gt; impl AiTree {
	tree! {
		&lt;sequence&gt;
			&lt;say_hello/&gt;
			&lt;say_world/&gt;
		&lt;/sequence&gt;
	}
}
</code></pre>
<blockquote>
<p><code>gamai</code> uses the same naming conventions as UI libraries like react or yew:</p>
<ul>
<li><code>node_systems</code> have snake_case </li>
<li><code>tree_builders</code> have PascalCase</li>
</ul>
</blockquote>
<h3 id="node-systems"><a class="header" href="#node-systems">Node Systems</a></h3>
<p>Any Bevy system can be used as a node, but usually we want to know whether it is in a running state for a given entity. Node systems are bevy systems that also accept an <code>AiNode</code> type argument, giving them access to the components that they need to communicate with parents and children.</p>
<p>Node Systems can be used to either run some behaviour (actions) or decide which child should run (selectors).</p>
<pre><code class="language-rs">#[node_system]
fn say_hello&lt;Node: AiNode&gt;(mut query: Query&lt;&amp;mut NodeState&lt;Node&gt;&gt;){
	
	for mut state in query.iter_mut(){
		println!(&quot;hello&quot;);
		assert_eq!(**state, NodeState::Running);
		//tell parent it can go to the next node now
		**state = NodeState::Success;
	}
}
</code></pre>
<h3 id="running"><a class="header" href="#running">Running</a></h3>
<p>An <code>AiNode</code> has two methods for running:</p>
<ul>
<li><code>MyTree.plugin()</code> provides the plugin that will add the systems to the world in the correct order.</li>
<li><code>MyTree.bundle()</code> provides the components nessecary for the tree to run for a given entity.</li>
</ul>
<pre><code class="language-rs">fn main(){
	let mut app = App::new();
	app.add_plugins(MyTree.plugin());
	app.world.spawn(MyTree.bundle());
	app.update(); // runs first child
	app.update(); // runs second child
}
</code></pre>
<pre><code class="language-sh">&gt; cargo run
hello
world
</code></pre>
<!-- > This example uses `bevy`, see [no_bevy](./no_bevy) for more examples. -->

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../sweet/changelog.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="../gamai/selectors.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../sweet/changelog.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="../gamai/selectors.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../src/custom/index.js"></script>


    </div>
    </body>
</html>
